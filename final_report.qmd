---
title: "Final Report"
author: "Isaac Yeoh, Jason Rivera, Somayeh Motevalli"
format: html
editor: visual
---

## BIOSTATS 272 Final Project

Import packages

```{r}
library(dplyr)
library(ggplot2)
library(sqldf)
library(tidyr)
library(infer)
library(countrycode)
```

## Group Replication Portion

### Graph Replication

This is the original graph that we intend to replicate

Read the data

```{r}
data <- read.csv("data/life_expectancy.csv")
```

## Isaac's Individual Portion

In this section, we will explore the question: Has HIV, TB, and Malaria deaths decreased between the years 2002 and 2013 globally?

-   Null Hypothesis (H₀): HIV, TB, and Malaria deaths globally have not decreased significantly over the years 2002 and 2013

-   Alternative Hypothesis (H₁): HIV, TB, and Malaria prevalence & deaths globally have decreased significantly over the years 2002 and 2013

To do this, first load in the datasets

```{r}
HIV_TB <- read.csv("data/HIV_TB_INCIDENCE_PREVALENCE_DEATHS.csv")
Malaria <- read.csv("data/MALARIA_INCIDENCE_DEATHS.csv")
```

Using the countrycode package, retrieve every country's ISO3 code, e.g: Australia = AUS

```{r}
valid_iso3 <- unique(countrycode::codelist$iso3c)
```

Perform data cleaning, filtering out invalid ISO3 codes, retrieving only "deaths" from "both sexes" in "all ages" from year "2002" and greater.

```{r}
HIV_TB_filtered <- HIV_TB %>%
  filter(age_group_name == "All Ages") %>%
  filter(location_code %in% valid_iso3) %>%
  filter(metric == "Deaths") %>%
  filter(unit == "Number") %>%
  filter(sex_name == "Both sexes") %>%
  filter(year >= 2002)

Malaria_filtered <- Malaria %>%
  filter(age_group_name == "All Ages") %>%
  filter(location_code %in% valid_iso3) %>%
  filter(metric == "Deaths") %>%
  filter(unit == "Number") %>%
  filter(sex_name == "Both sexes") %>%
  filter(year >= 2002)
```

Pull HIV means for each country in years 2002 and 2013

```{r}
HIV_2002 <- HIV_TB_filtered %>%
  filter(year == 2002) %>%
  filter(cause_name == "HIV/AIDS") %>%
  pull(mean)

HIV_2002 <- as.numeric(HIV_2002)

HIV_2013 <- HIV_TB_filtered %>%
  filter(year == 2013) %>%
  filter(cause_name == "HIV/AIDS") %>%
  pull(mean)

HIV_2013 <- as.numeric(HIV_2013)
```

Similarly, pull TB and Malaria means for each country in years 2002 and 2013

```{r}
TB_2002 <- HIV_TB_filtered %>%
  filter(year == 2002) %>%
  filter(cause_name == "Tuberculosis") %>%
  pull(mean)

TB_2002 <- as.numeric(TB_2002)

TB_2013 <- HIV_TB_filtered %>%
  filter(cause_name == "Tuberculosis") %>%
  filter(year == 2013) %>%
  pull(mean)

TB_2013 <- as.numeric(TB_2013)
```

```{r}
Malaria_2002 <- Malaria_filtered %>%
  filter(year == 2002) %>%
  filter(cause_name == "Malaria") %>%
  pull(mean)

Malaria_2002 <- as.numeric(Malaria_2002)

Malaria_2013 <- Malaria_filtered %>%
  filter(cause_name == "Malaria") %>%
  filter(year == 2013) %>%
  pull(mean)

Malaria_2013 <- as.numeric(Malaria_2013)
```

Now, perform hypothesis testing for each disease. Starting with HIV:

```{r}
HIV_t_test <- t.test(
  x = HIV_2002,
  y = HIV_2013,
  alternative = "two.sided", 
  paired = TRUE,
  conf.level = 0.95
)
HIV_t_test
```

The t value is 0.752, and the p-value is 0.453. Since p \> 0.05, we fail to reject the null hypothesis. Thus, HIV deaths have not decreased significantly between the years 2002 and 2013 globally. Moving on to TB:

```{r}
TB_t_test <- t.test(
  x = TB_2002,
  y = TB_2013,
  alternative = "two.sided", 
  paired = TRUE,
  conf.level = 0.95
)
TB_t_test
```

The t value is 2.081, and the p-value is 0.0388. Since p \< 0.05, we reject the null hypothesis and accept the alternate for TB deaths. Thus, TB deaths have decreased significantly between the years 2002 and 2013 globally. Finally for malaria:

```{r}
Malaria_t_test <- t.test(
  x = Malaria_2002,
  y = Malaria_2013,
  alternative = "two.sided", 
  paired = TRUE,
  conf.level = 0.95
)
Malaria_t_test
```

The t value is 4.464, and the p-value is 1.389e-05. Since p \< 0.05, we reject the null hypothesis and accept the alternate for malaria deaths. Thus, malaria deaths have decreased significantly between the years 2002 and 2013 globally.

In conclusion, HIV deaths have not decreased significantly between the years 2002 and 2013. However, TB and malaria have both decreased significantly.
